---
// Navbar.astro
const navItems = [
    { name: "Features", href: "#features" },
    { name: "Benefits", href: "#benefits" },
    { name: "Contact", href: "#contact" },
];
---

<header
    id="navbar"
    class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-transparent"
>
    <div class="relative container mx-auto px-6 lg:px-8">
        <div
            class="flex items-center justify-between h-24 transition-all duration-300"
            id="nav-container"
        >
            <!-- Logo -->
            <a href="#hero" class="flex items-center gap-3 group relative z-50">
                <div
                    class="w-12 h-12 bg-teal-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform shadow-lg"
                >
                    <svg
                        class="w-7 h-7 text-white"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
                        ></path>
                    </svg>
                </div>
                <span class="text-2xl font-black text-white drop-shadow-md"
                    >Agenium</span
                >
            </a>

            <!-- Desktop Navigation -->
            <nav class="hidden lg:flex items-center gap-8">
                {
                    navItems.map((item) => (
                        <a
                            href={item.href}
                            class="nav-link text-sm font-medium text-blue-100/80 hover:text-white transition-colors duration-300 relative group"
                        >
                            {item.name}
                            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-teal-400 transition-all duration-300 group-hover:w-full" />
                        </a>
                    ))
                }
                <a
                    href="#contact"
                    class="ml-4 text-white hover:text-teal-400 font-medium px-4 py-2 rounded-full transition-all duration-300 flex items-center justify-center"
                >
                    Request Demo
                </a>
            </nav>

            <!-- Mobile Menu Button -->
            <button
                id="mobile-menu-btn"
                class="lg:hidden relative z-50 p-2 text-white focus:outline-none"
                aria-label="Toggle navigation"
            >
                <div
                    class="w-8 h-8 flex flex-col justify-center items-center gap-1.5 overflow-hidden"
                >
                    <span
                        class="w-6 h-0.5 bg-white transition-all duration-300 origin-center"
                        id="hamburger-top"></span>
                    <span
                        class="w-6 h-0.5 bg-white transition-all duration-300"
                        id="hamburger-middle"></span>
                    <span
                        class="w-6 h-0.5 bg-white transition-all duration-300 origin-center"
                        id="hamburger-bottom"></span>
                </div>
            </button>
        </div>
    </div>

    <!-- Mobile Menu Backdrop -->
    <div
        id="mobile-menu-backdrop"
        class="fixed inset-0 z-40 bg-black/60 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-300 lg:hidden"
        aria-hidden="true"
    >
    </div>

    <!-- Mobile Menu Drawer -->
    <div
        id="mobile-menu-drawer"
        class="fixed top-0 right-0 h-full w-72 bg-gradient-to-b from-blue-950 to-blue-900 shadow-2xl z-50 transform translate-x-full transition-transform duration-300 ease-out lg:hidden flex flex-col"
    >
        <!-- Drawer Header -->
        <div
            class="flex items-center justify-between p-6 border-b border-blue-800/50"
        >
            <h2 class="text-xl font-bold text-white">Menu</h2>
            <button
                id="mobile-menu-close"
                class="p-2 text-white hover:text-teal-400 transition-colors"
                aria-label="Close navigation"
            >
                <svg
                    class="w-6 h-6"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <!-- Navigation Links -->
        <nav class="flex-1 overflow-y-auto py-6">
            <ul class="flex flex-col">
                {
                    navItems.map((item) => (
                        <li>
                            <a
                                href={item.href}
                                class="mobile-nav-link block px-6 py-4 text-white hover:bg-blue-800/50 hover:text-teal-400 transition-all font-medium text-lg border-l-4 border-transparent hover:border-teal-500"
                            >
                                {item.name}
                            </a>
                        </li>
                    ))
                }
                <li class="px-6 pt-6">
                    <a
                        href="#contact"
                        class="mobile-nav-link block w-full bg-teal-600 hover:bg-teal-500 text-white font-bold px-6 py-4 rounded-xl text-center transition-all shadow-lg"
                    >
                        Request Demo
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Drawer Footer -->
        <div class="p-6 border-t border-blue-800/50">
            <p class="text-sm text-blue-300 text-center">Â© 2026 AgeniumTrack</p>
        </div>
    </div>
</header>

<script>
    const navbar = document.getElementById("navbar");
    const navContainer = document.getElementById("nav-container");
    const mobileBtnOpen = document.getElementById("mobile-menu-btn");
    const mobileBtnClose = document.getElementById("mobile-menu-close");
    const mobileBackdrop = document.getElementById("mobile-menu-backdrop");
    const mobileDrawer = document.getElementById("mobile-menu-drawer");
    const navLinks = document.querySelectorAll(".nav-link");

    let isMenuOpen = false;

    // Sticky Scroll Handler
    function handleScroll() {
        if (window.scrollY > 20) {
            navbar?.classList.add(
                "bg-blue-950/80",
                "backdrop-blur-md",
                "shadow-2xl",
                "border-b",
                "border-white/5",
            );
            navbar?.classList.remove("bg-transparent");
            navContainer?.classList.remove("h-24");
            navContainer?.classList.add("h-20");
        } else {
            navbar?.classList.remove(
                "bg-blue-950/80",
                "backdrop-blur-md",
                "shadow-2xl",
                "border-b",
                "border-white/5",
            );
            navbar?.classList.add("bg-transparent");
            navContainer?.classList.add("h-24");
            navContainer?.classList.remove("h-20");
        }
    }

    window.addEventListener("scroll", handleScroll);
    handleScroll(); // Init

    // Mobile Menu Toggle
    function toggleMenu() {
        isMenuOpen = !isMenuOpen;
        document.body.style.overflow = isMenuOpen ? "hidden" : "";

        if (isMenuOpen) {
            mobileBackdrop?.classList.remove(
                "opacity-0",
                "pointer-events-none",
            );
            mobileBackdrop?.classList.add("opacity-100", "pointer-events-auto");

            mobileDrawer?.classList.remove("translate-x-full");
            mobileDrawer?.classList.add("translate-x-0");
        } else {
            mobileBackdrop?.classList.remove(
                "opacity-100",
                "pointer-events-auto",
            );
            mobileBackdrop?.classList.add("opacity-0", "pointer-events-none");

            mobileDrawer?.classList.remove("translate-x-0");
            mobileDrawer?.classList.add("translate-x-full");
        }
    }

    mobileBtnOpen?.addEventListener("click", toggleMenu);
    mobileBtnClose?.addEventListener("click", toggleMenu);
    mobileBackdrop?.addEventListener("click", toggleMenu);

    // Smooth Scroll & Mobile Link Click
    document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            const currentAnchor = e.currentTarget as HTMLAnchorElement;
            const href = currentAnchor.getAttribute("href");
            if (href) {
                const target = document.querySelector(href);
                if (target) {
                    if (isMenuOpen) toggleMenu();
                    const offset = 80; // Offset for sticky header
                    const elementPosition = target.getBoundingClientRect().top;
                    const offsetPosition =
                        elementPosition + window.pageYOffset - offset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: "smooth",
                    });
                }
            }
        });
    });

    // Active State Observer
    const observerOptions = {
        root: null,
        rootMargin: "-20% 0px -70% 0px",
        threshold: 0,
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
            if (entry.isIntersecting) {
                const id = entry.target.getAttribute("id");

                navLinks.forEach((link) => {
                    link.classList.remove("text-white", "font-semibold");
                    link.classList.add("text-blue-100/80");
                });

                if (id) {
                    const activeLink = document.querySelector(
                        `.nav-link[href="#${id}"]`,
                    );
                    if (activeLink) {
                        activeLink.classList.remove("text-blue-100/80");
                        activeLink.classList.add("text-white", "font-semibold");
                    }
                }
            }
        });
    }, observerOptions);

    document.querySelectorAll("section[id]").forEach((section) => {
        observer.observe(section);
    });
</script>
